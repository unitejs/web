/**
 * Gulp utils for AMD module configuration.
 */
const os = require("os");
const clientPackages = require("./client-packages");

function create (uniteConfig, includeModes, isBundle, mapBase) {
    const moduleConfig = clientPackages.buildModuleConfig(uniteConfig, includeModes, isBundle);

    const rjsConfig = {
        "paths": moduleConfig.paths,
        "packages": moduleConfig.packages,
        "map": {
            "*": {}
        }
    };

    Object.keys(moduleConfig.map).forEach(key => {
        rjsConfig.map["*"][key] = moduleConfig.map[key];
    });

    const jsonConfig = JSON.stringify(rjsConfig, undefined, "\t");
    const jsonPreload = JSON.stringify(moduleConfig.preload, undefined, "\t");

    let config = `require.config(${jsonConfig});${os.EOL}`;
    config += `preloadModules = ${jsonPreload};${os.EOL}`;

    return config;
}

module.exports = {
    create
};

/* Generated by UniteJS */
